<!DOCTYPE HTML>
<html lang="en">


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/page-form-product-1.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:33:31 GMT -->
<head>
    <meta charset="utf-8">
    <title>Evara Dashboard</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="assets/imgs/theme/favicon.svg">
    <!-- Template CSS -->
    <link href="assets/css/main.css" rel="stylesheet" type="text/css" />
    <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css"
  />
  <style>
    .color-quantities-container {
      background-color: #f8f9fa;
      border-radius: 8px;
      padding: 2rem;
      margin-bottom: 2rem;
    }
  
    .section-title {
      font-size: 1.5rem;
      color: #333;
      margin-bottom: 1.5rem;
      text-align: center;
    }
  
    .color-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
    }
  
    .color-item {
      background-color: #ffffff;
      border-radius: 8px;
      padding: 1.5rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s ease-in-out;
    }
  
    .color-item:hover {
      transform: translateY(-5px);
    }
  
    .color-item-red { border-top: 4px solid #ff6b6b; }
    .color-item-black { border-top: 4px solid #343a40; }
    .color-item-green { border-top: 4px solid #51cf66; }
    .color-item-yellow { border-top: 4px solid #fcc419; }
  
    .color-name {
      font-size: 1.2rem;
      color: #495057;
      margin-bottom: 1rem;
      text-align: center;
    }
  
    .input-group {
      margin-bottom: 1rem;
    }
  
    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      color: #495057;
      font-weight: 500;
    }
  
    .form-control {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #ced4da;
      border-radius: 4px;
      font-size: 1rem;
    }
  
    .file-input {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #ced4da;
      border-radius: 4px;
      font-size: 0.9rem;
      background-color: #f8f9fa;
    }
  
    .error-message {
      color: #dc3545;
      font-size: 0.9rem;
      margin-top: 1rem;
    }
  
    @media (max-width: 768px) {
      .color-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>

</head>

<body>
    <div class="screen-overlay"></div>
    <aside class="navbar-aside" id="offcanvas_aside">
        <div class="aside-top">
            <a href="index.html" class="brand-wrap">
                <img src="assets/imgs/theme/logo.svg" class="logo" alt="Evara Dashboard">
            </a>
            <div>
                <button class="btn btn-icon btn-aside-minimize"> <i class="text-muted material-icons md-menu_open"></i> </button>
            </div>
        </div>
        <nav>
            <ul class="menu-aside">
                <li class="menu-item">
                    <a class="menu-link" href="home"> <i class="icon material-icons md-home"></i>
                        <span class="text">Dashboard</span>
                    </a>
                </li>
                <li class="menu-item active">
                    <a class="menu-link" href="products"> <i class="icon material-icons md-shopping_bag"></i>
                        <span class="text">Products</span>
                    </a>
                    <!-- <div class="submenu">
                        <a href="page-products-list.html">Product List</a>
                        <a href="page-products-grid.html">Product grid</a>
                        <a href="page-products-grid-2.html">Product grid 2</a>
                        <a href="page-categories.html">Categories</a>
                    </div> -->
                </li>
                <li class="menu-item ">
                    <a class="menu-link" href="order"> <i class="icon material-icons md-shopping_cart"></i>
                        <span class="text">Orders</span>
                    </a>
                    <!-- <div class="submenu">
                        <a href="page-orders-1.html">Order list 1</a>
                        <a href="page-orders-2.html">Order list 2</a>
                        <a href="page-orders-detail.html">Order detail</a>
                    </div> -->
                </li>
                <!-- <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-sellers-cards.html"> <i class="icon material-icons md-store"></i>
                        <span class="text">Sellers</span>
                    </a>
                    <div class="submenu">
                        <a href="page-sellers-cards.html">Sellers cards</a>
                        <a href="page-sellers-list.html">Sellers list</a>
                        <a href="page-seller-detail.html">Seller profile</a>
                    </div>
                </li> -->
                <!-- <li class="menu-item has-submenu active">
                    <a class="menu-link" href="page-form-product-1.html"> <i class="icon material-icons md-add_box"></i>
                        <span class="text">Add product</span>
                    </a> -->
                    <!-- <div class="submenu">
                        <a href="page-form-product-1.html" class="active">Add product 1</a>
                        <a href="page-form-product-2.html">Add product 2</a>
                        <a href="page-form-product-3.html">Add product 3</a>
                        <a href="page-form-product-4.html">Add product 4</a>
                    </div> -->
                <!-- </li> -->
                <!-- <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-transactions-1.html"> <i class="icon material-icons md-monetization_on"></i>
                        <span class="text">Transactions</span>
                    </a>
                    <div class="submenu">
                        <a href="page-transactions-1.html">Transaction 1</a>
                        <a href="page-transactions-2.html">Transaction 2</a>
                    </div>
                </li> -->
                <!-- <li class="menu-item has-submenu">
                    <a class="menu-link" href="#"> <i class="icon material-icons md-person"></i>
                        <span class="text">Account</span>
                    </a>
                    <div class="submenu">
                        <a href="page-account-login.html">User login</a>
                        <a href="page-account-register.html">User registration</a>
                        <a href="page-error-404.html">Error 404</a>
                    </div>
                </li>
                <li class="menu-item">
                    <a class="menu-link" href="page-reviews.html"> <i class="icon material-icons md-comment"></i>
                        <span class="text">Reviews</span>
                    </a> -->
                </li>
                <li class="menu-item">
                    <a class="menu-link" href="brands"> <i class="icon material-icons md-stars"></i>
                        <span class="text">Brands</span> </a>
                </li>
                <li class="menu-item ">
                    <a class="menu-link" href="category"> <i class="icon material-icons md-stars"></i>
                        <span class="text">Categories</span> </a>
                </li>
                <li class="menu-item ">
                    <a class="menu-link" href="users"> <i class="icon material-icons md-person"></i>
                        <span class="text">users</span> </a>
                </li>
                <!-- <li class="menu-item">
                    <a class="menu-link" disabled href="#"> <i class="icon material-icons md-pie_chart"></i>
                        <span class="text">Statistics</span>
                    </a>
                </li> -->
            </ul>
            <!-- <hr>
            <ul class="menu-aside">
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="#"> <i class="icon material-icons md-settings"></i>
                        <span class="text">Settings</span>
                    </a>
                    <div class="submenu">
                        <a href="page-settings-1.html">Setting sample 1</a>
                        <a href="page-settings-2.html">Setting sample 2</a>
                    </div>
                </li>
                <li class="menu-item">
                    <a class="menu-link" href="page-blank.html"> <i class="icon material-icons md-local_offer"></i>
                        <span class="text"> Starter page </span>
                    </a>
                </li>
            </ul> -->
            <br>
            <br>
        </nav>
    </aside>
    <main class="main-wrap">
        <header class="main-header navbar">
            <div class="col-search">
                <form class="searchform">
                    <div class="input-group">
                        <input list="search_terms" type="text" class="form-control" placeholder="Search term">
                        <button class="btn btn-light bg" type="button"> <i class="material-icons md-search"></i></button>
                    </div>
                    <datalist id="search_terms">
                        <option value="Products">
                        <option value="New orders">
                        <option value="Apple iphone">
                        <option value="Ahmed Hassan">
                    </datalist>
                </form>
            </div>
            <div class="col-nav">
                <button class="btn btn-icon btn-mobile me-auto" data-trigger="#offcanvas_aside"> <i class="material-icons md-apps"></i> </button>
                <ul class="nav">
                    <li class="nav-item">
                        <a class="nav-link btn-icon" href="#">
                            <i class="material-icons md-notifications animation-shake"></i>
                            <span class="badge rounded-pill">3</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link btn-icon darkmode" href="#"> <i class="material-icons md-nights_stay"></i> </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="requestfullscreen nav-link btn-icon"><i class="material-icons md-cast"></i></a>
                    </li>
                    <li class="dropdown nav-item">
                        <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownLanguage" aria-expanded="false"><i class="material-icons md-public"></i></a>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownLanguage">
                            <a class="dropdown-item text-brand" href="#"><img src="assets/imgs/theme/flag-us.png" alt="English">English</a>
                            <a class="dropdown-item" href="#"><img src="assets/imgs/theme/flag-fr.png" alt="Français">Français</a>
                            <a class="dropdown-item" href="#"><img src="assets/imgs/theme/flag-jp.png" alt="Français">日本語</a>
                            <a class="dropdown-item" href="#"><img src="assets/imgs/theme/flag-cn.png" alt="Français">中国人</a>
                        </div>
                    </li>
                    <li class="dropdown nav-item">
                        <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownAccount" aria-expanded="false"> <img class="img-xs rounded-circle" src="assets/imgs/people/avatar2.jpg" alt="User"></a>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownAccount">
                            <a class="dropdown-item" href="#"><i class="material-icons md-perm_identity"></i>Edit Profile</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-settings"></i>Account Settings</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-account_balance_wallet"></i>Wallet</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-receipt"></i>Billing</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-help_outline"></i>Help center</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item text-danger" href="#"><i class="material-icons md-exit_to_app"></i>Logout</a>
                        </div>
                    </li>
                </ul>
            </div>
        </header>
        <section class="content-main">
            <div class="row">
                <div class="col-9">
                    <div class="content-header">
                        <h2 class="content-title">Add New Product</h2>
                        <p style="color: red;"><%= error_message %></p>
                    </div>
                </div>
            
                <div class="col-lg-6">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h4>Basic Product Information</h4>
                        </div>
                        <div class="card-body">
                            <form action="/admin/addproducts" method="POST" onsubmit="return validateForm()" enctype="multipart/form-data">
            
                                <!-- Product Name -->
                                <div class="mb-4">
                                    <label for="product_name" class="form-label">Product Name</label>
                                    <input type="text" placeholder="Type here" class="form-control" id="product_name" name="productName">
                                    <span id="nameError" class="error-message text-danger"></span>
                                </div>
            
                                <!-- Full Description -->
                                <div class="mb-4">
                                    <label class="form-label">Full Description</label>
                                    <textarea placeholder="Type here" class="form-control" rows="4" name="productDescription" id="product_description"></textarea>
                                    <span id="descriptionError" class="error-message text-danger"></span>
                                </div>
            
                                <!-- Price -->
                                <div class="row mb-4">
                                    <div class="col-md-12">
                                        <label class="form-label">Price</label>
                                        <input type="text" placeholder="Rs" class="form-control" id="product_price" name="price">
                                        <span id="priceError" class="error-message text-danger"></span>
                                    </div>
                                </div>
            
                                <!-- Category & Brand -->
                                <div class="row mb-4">
                                    <div class="col-md-6">
                                        <label class="form-label">Category</label>
                                        <select class="form-select" name="product_category">
                                            <% category.forEach(element => { %>
                                                <option value="<%= element._id %>"> <%= element.name %> </option>
                                            <% }); %>
                                        </select>
                                        <span id="categoryError" class="error-message text-danger"></span>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Brand</label>
                                        <select class="form-select" name="product_brand">
                                            <% brand.forEach(element => { %>
                                                <option value="<%= element._id %>"> <%= element.name %> </option>
                                            <% }); %>
                                        </select>
                                        <span id="brandError" class="error-message text-danger"></span>
                                    </div>
                                </div>
            
                                <!-- Color Quantities and Image Uploads -->
                                <div class="color-quantities-container">
                                    <h2 class="section-title">Color Quantities & Image Uploads</h2>
                                    <div class="color-grid">
                                      <div class="color-item color-item-red">
                                        <h3 class="color-name">Red</h3>
                                        <div class="input-group">
                                          <label for="red_quantity" class="form-label">Quantity</label>
                                          <input type="number" placeholder="Enter quantity" class="form-control" id="red_quantity" name="colors[red][quantity]" min="0">
                                        </div>
                                        <div class="input-group">
                                          <label for="red_images" class="form-label">Upload Images</label>
                                          <input type="file" id="red_images" name="colors[red][images][]" multiple accept="image/jpeg, image/png, image/webp, image/svg+xml" class="file-input">
                                        </div>
                                      </div>
                                      <div class="color-item color-item-black">
                                        <h3 class="color-name">Black</h3>
                                        <div class="input-group">
                                          <label for="black_quantity" class="form-label">Quantity</label>
                                          <input type="number" placeholder="Enter quantity" class="form-control" id="black_quantity" name="colors[black][quantity]" min="0">
                                        </div>
                                        <div class="input-group">
                                          <label for="black_images" class="form-label">Upload Images</label>
                                          <input type="file" id="black_images" name="colors[black][images][]" multiple accept="image/jpeg, image/png, image/webp, image/svg+xml" class="file-input">
                                        </div>
                                      </div>
                                      <div class="color-item color-item-green">
                                        <h3 class="color-name">Green</h3>
                                        <div class="input-group">
                                          <label for="green_quantity" class="form-label">Quantity</label>
                                          <input type="number" placeholder="Enter quantity" class="form-control" id="green_quantity" name="colors[green][quantity]" min="0">
                                        </div>
                                        <div class="input-group">
                                          <label for="green_images" class="form-label">Upload Images</label>
                                          <input type="file" id="green_images" name="colors[green][images][]" multiple accept="image/jpeg, image/png, image/webp, image/svg+xml" class="file-input">
                                        </div>
                                      </div>
                                      <div class="color-item color-item-yellow">
                                        <h3 class="color-name">Yellow</h3>
                                        <div class="input-group">
                                          <label for="yellow_quantity" class="form-label">Quantity</label>
                                          <input type="number" placeholder="Enter quantity" class="form-control" id="yellow_quantity" name="colors[yellow][quantity]" min="0">
                                        </div>
                                        <div class="input-group">
                                          <label for="yellow_images" class="form-label">Upload Images</label>
                                          <input type="file" id="yellow_images" name="colors[yellow][images][]" multiple accept="image/jpeg, image/png, image/webp, image/svg+xml" class="file-input">
                                        </div>
                                      </div>
                                    </div>
                                    <div id="colorQuantityError" class="error-message" aria-live="polite"></div>
                                  </div>
                                  
            
                                <!-- Size Quantities -->
                                <div class="mb-4">
                                    <h5>Size Quantities</h5>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label for="small" class="form-label">Small</label>
                                            <input type="text" placeholder="Type here" class="form-control" id="small" name="small">
                                        </div>
                                        <div class="col-md-4">
                                            <label for="medium" class="form-label">Medium</label>
                                            <input type="text" placeholder="Type here" class="form-control" id="medium" name="medium">
                                        </div>
                                        <div class="col-md-4">
                                            <label for="large" class="form-label">Large</label>
                                            <input type="text" placeholder="Type here" class="form-control" id="large" name="large">
                                        </div>
                                    </div>
                                    <span id="sizeQuantityError" class="error-message text-danger"></span>
                                </div>
            
                                <!-- Gender & Frame Color -->
                                <div class="row mb-4">
                                    <div class="col-md-6">
                                        <label class="form-label">Gender</label>
                                        <select class="form-select" name="product_gender">
                                            <option value="Male">Male</option>
                                            <option value="Female">Female</option>
                                            <option value="Unisex">Unisex</option>
                                            <option value="Kids">Kids</option>
                                        </select>
                                        <span id="genderError" class="error-message text-danger"></span>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Frame Color</label>
                                        <select class="form-select" name="frame_color">
                                            <option value="Gold">Gold</option>
                                            <option value="Silver">Silver</option>
                                            <option value="Black">Black</option>
                                            <option value="Glass">Glass</option>
                                            <option value="Brown">Brown</option>
                                        </select>
                                        <span id="frameColorError" class="error-message text-danger"></span>
                                    </div>
                                </div>
            
                                <!-- Material & Frame Style -->
                                <div class="row mb-4">
                                    <div class="col-md-6">
                                        <label class="form-label">Material</label>
                                        <select class="form-select" name="material">
                                            <option value="Plastic">Plastic</option>
                                            <option value="Metal">Metal</option>
                                            <option value="Mixed">Mixed</option>
                                        </select>
                                        <span id="materialError" class="error-message text-danger"></span>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Frame Style</label>
                                        <select class="form-select" name="frame_style">
                                            <option value="Rectangle">Rectangle</option>
                                            <option value="Square">Square</option>
                                            <option value="Round">Round</option>
                                            <option value="Aviator">Aviator</option>
                                            <option value="Oval">Oval</option>
                                        </select>
                                        <span id="frameStyleError" class="error-message text-danger"></span>
                                    </div>
                                </div>
            
                                <!-- Submit Button -->
                                <button class="btn btn-md rounded font-sm hover-up">ADD</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>
         <!-- content-main end// -->
        <footer class="main-footer font-xs">
            <div class="row pb-30 pt-15">
                <div class="col-sm-6">
                    <script>
                    document.write(new Date().getFullYear())
                    </script> ©, Evara - HTML Ecommerce Template .
                </div>
                <div class="col-sm-6">
                    <div class="text-sm-end">
                        All rights reserved
                    </div>
                </div>
            </div>
        </footer>
    </main>
    <style>
        .error-message{
            color: red;
        }
    </style>
    <script src="assets/js/vendors/jquery-3.6.0.min.js"></script>
    <script src="assets/js/vendors/bootstrap.bundle.min.js"></script>
    <script src="assets/js/vendors/select2.min.js"></script>
    <script src="assets/js/vendors/perfect-scrollbar.js"></script>
    <script src="assets/js/vendors/jquery.fullscreen.min.js"></script>
    <!-- Main Script -->
    <script src="assets/js/main.js" type="text/javascript"></script>
    <script>  
        let currentColor = '';

            function handleFiles(event, color) {
                currentColor = color;
                const files = event.target.files;
                if (files && files.length > 0) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        document.getElementById('croppingImage').src = e.target.result;
                        document.getElementById('cropModal').style.display = 'block';
                    };
                    reader.readAsDataURL(files[0]); // Show the first image for cropping
                }
            }

            // function cropImage() {
            //     const croppedData = // your cropping logic here (you can use a library like Cropper.js);
            //     document.getElementById('cropModal').style.display = 'none';

            //     // You would then attach this croppedData to the corresponding color field
            //     // e.g., for red: document.getElementById('red_images').value = croppedData;
            // }
                        
      </script>
 <script>
    function validateForm() {
        let isValid = true;

        // Get input values
        let name = document.getElementById("product_name").value;
        let description = document.getElementById("product_description").value;
        let price = document.getElementById("product_price").value;
        let redQty = document.getElementById("red_quantity").value;
        let blackQty = document.getElementById("black_quantity").value;
        let greenQty = document.getElementById("green_quantity").value;
        let yellowQty = document.getElementById("yellow_quantity").value;
        let small = document.getElementById("small").value;
        let medium = document.getElementById("medium").value;
        let large = document.getElementById("large").value;

        // Clear previous error messages
        document.getElementById("nameError").innerText = "";
        document.getElementById("descriptionError").innerText = "";
        document.getElementById("priceError").innerText = "";
        document.getElementById("colorQuantityError").innerText = "";
        document.getElementById("sizeQuantityError").innerText = "";

        // Product Name validation
        if (!name.trim()) {
            document.getElementById("nameError").innerText = "Product name is required.";
            isValid = false;
        }

        // Description validation
        if (!description.trim()) {
            document.getElementById("descriptionError").innerText = "Product description is required.";
            isValid = false;
        }

        // Price validation (must be a positive number)
        if (!price || isNaN(price) || parseFloat(price) <= 0) {
            document.getElementById("priceError").innerText = "Price must be a positive number.";
            isValid = false;
        }

        // Color Quantity validation (at least one non-negative quantity required)
        let hasColorQty = false;
        let colorQuantities = [
            { qty: redQty, id: "red_quantity" },
            { qty: blackQty, id: "black_quantity" },
            { qty: greenQty, id: "green_quantity" },
            { qty: yellowQty, id: "yellow_quantity" }
        ];

        for (let color of colorQuantities) {
            if (color.qty) {
                if (isNaN(color.qty) || parseInt(color.qty) < 0) {
                    document.getElementById("colorQuantityError").innerText = "Color quantities must be non-negative numbers.";
                    isValid = false;
                    break;
                } else {
                    hasColorQty = true;
                }
            }
        }

        if (!hasColorQty) {
            document.getElementById("colorQuantityError").innerText = "At least one color quantity is required.";
            isValid = false;
        }

        // Size Quantity validation (must be non-negative and at least one required)
        let hasSizeQty = false;
        let sizeQuantities = [
            { qty: small, id: "small" },
            { qty: medium, id: "medium" },
            { qty: large, id: "large" }
        ];

        for (let size of sizeQuantities) {
            if (size.qty) {
                if (isNaN(size.qty) || parseInt(size.qty) < 0) {
                    document.getElementById("sizeQuantityError").innerText = "Size quantities cannot be negative.";
                    isValid = false;
                    break;
                } else {
                    hasSizeQty = true;
                }
            }
        }

        if (!hasSizeQty && isValid) {
            document.getElementById("sizeQuantityError").innerText = "At least one size quantity is required.";
            isValid = false;
        }

        return isValid;
    }
</script>


    

      <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>
    
    <script>
        let cropper;
        let currentFile;
        let currentImgElement;
        let filesArray = []; // To keep track of all selected files
        let croppedFileIndex; // To track the index of the cropped file
    
        function handleFiles(event) {
            const imagePreviewContainer = document.getElementById("imagePreview");
            imagePreviewContainer.innerHTML = "";
    
            const files = event.target.files;
            filesArray = Array.from(files); // Store the selected files in an array
    
            if (files) {
                Array.from(files).forEach((file, index) => {
                    const reader = new FileReader();
    
                    reader.onload = (e) => {
                        currentFile = file;
                        const img = document.createElement("img");
                        img.src = e.target.result;
                        img.style.width = "100px";
                        img.style.marginRight = "10px";
                        img.style.cursor = "pointer";
                        img.onclick = () => openCropper(e.target.result, img, index); // Pass index to identify file in array
                        imagePreviewContainer.appendChild(img);
                    };
    
                    reader.readAsDataURL(file);
                });
            }
        }
    
        function openCropper(imageSrc, imgElement, index) {
            const cropModal = document.getElementById("cropModal");
            const croppingImage = document.getElementById("croppingImage");
    
            currentImgElement = imgElement;
            croppedFileIndex = index; // Store index of file being cropped
    
            croppingImage.src = imageSrc;
            cropModal.style.display = "block";
    
            if (cropper) {
                cropper.destroy();
            }
    
            cropper = new Cropper(croppingImage, {
                aspectRatio: 1,
                viewMode: 2,
            });
        }
    
        function cropImage() {
            const canvas = cropper.getCroppedCanvas();
    
            canvas.toBlob((blob) => {
                const croppedFile = new File([blob], currentFile.name, { type: 'image/png' });
    
                filesArray[croppedFileIndex] = croppedFile; // Replace the original file with the cropped one
    
                // Now, reassign all files (including cropped) to the input field
                const dataTransfer = new DataTransfer();
                
                filesArray.forEach((file) => {
                    dataTransfer.items.add(file); // Add all files (cropped and uncropped)
                });
    
                const fileInput = document.getElementById('images');
                fileInput.files = dataTransfer.files; // Update the file input with all files
    
                // Update the preview with cropped image
                currentImgElement.src = URL.createObjectURL(croppedFile);
    
                // Close the crop modal
                document.getElementById("cropModal").style.display = "none";
    
                // Destroy the cropper to clean up
                cropper.destroy();
                cropper = null;
            }, 'image/png');
        }
    </script>
</body>


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/page-form-product-1.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:33:32 GMT -->
</html>